\section{Design of the \name file exchange system}

\subsection{Outline}

We present a global outline of \name before covering each of its building block in depth in the next subsections.


Alice and Bob each has a set of devices containing their files, \eg a 
smartphone, laptop and a desktop computer.
Alice and Bob meet in a caf√© carrying only their smartphones and Alice wants to 
share a file, \(f\), with Bob.
Alice's smartphone knows some metadata of \(f\) and that it resides on Alice's 
desktop computer.
She gives some metadata about \(f\) to Bob, at least the file size.
Bob creates an onion route of low-availability devices with some subset of Bob's 
devices as the destination.
The layers of the route are chosen such that the probability of all devices 
being offline at the same time is low.
Bob gives this route to Alice.
Alice's smartphone ensures that her desktop computer (containing the file \(f\)) 
gets the route and the instruction to send \(f\) using this route.
When Alice's desktop computer receives this instruction it will create the first 
half of the route and concatenate it with Bob's route, then transfer \(f\) to 
Bob.
In this section we will present the details of the necessary algorithms.

We have a set of users, \(U\), each user \(u\in U\) has a set of devices, 
\(D_u\).
We call \(D_u\) the device swarm of \(u\).
Alice, \(a\in U\), has a device swarm, \(D_a\), and Bob, \(b\in U\) has a device 
swarm, \(D_b\).
We let \(D = \cup_{u\in U} D_u\) be the set of all devices, the global device 
swarm.
Without loss of generality, we will use Alice, with device swarm \(D_a\), and 
Bob, with device swarm \(D_b\), as examples.


\include*{building-blocks}
\include*{squad-overlay-design}
\include*{global-overlay-design}
\include*{message-passing}
\include*{file-exchange}
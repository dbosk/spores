\section{Security analysis}%
\label{SecurityAnalysis}

\commentDaniel{Under editing.}

Alice wants to prevent Bob from learning which are her devices. Bob is allowed 
to infer the behaviour of devices in the global device swarm, a file transfer 
from Alice should not give Bob any information about which devices are Alice's.

We also prevent Carol and David to know that Alice and Bob exchanged a file. 
They forwarded unknown messages.

The message \(m\) remains the same from hop to hop during the onion routing, 
hence a global observer can track the message through the network.
The same applies if one node occurs more than once in a route, \eg in both 
Alice's and Bob's part of the route.

Since we have an in-package header, each node on the route can infer its 
position on the route.
\commentDaniel{Maybe this can be solved by issue \#33.}

Since we choose a new key for every file, we have forward secrecy between files.
\Eg an adversary who compromises either Alice or Bob cannot determine what Alice 
sent to Bob.

We can choose different properties for \(\Enc*\).
What makes sense is to choose at least an authenticated encryption 
scheme~\cite{AuthEncryption}.
We could also choose a deniable encryption scheme~\cite{DeniableEncryption}, \eg 
the one by \textcite{OTPKX} which is both deniable and authenticated and 
provides \ac{DEN-SS}.
